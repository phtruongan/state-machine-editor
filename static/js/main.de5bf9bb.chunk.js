(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{129:function(e,t,a){e.exports=a(244)},134:function(e,t,a){},244:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(15),o=a.n(i),s=(a(134),a(28)),l=a(29),c=a(32),u=a(30),p=a(33),d=a(6),g=a(75),m=a.n(g),h=a(26),f=a.n(h),b=a(16),y=a.n(b),S=a(124),E=a.n(S),M=a(72),v=a.n(M),T=a(24),w=a.n(T),N=a(31),I=a.n(N);function O(e,t){if((t=t.model||t)instanceof w.a.dia.Element)I.a.chain(e.getConnectedLinks(t)).groupBy(function(e){return I.a.omit([e.source().id,e.target().id],t.id)[0]}).each(function(t,a){"undefined"!==a&&O(e,I.a.first(t))}).value();else{var a=t.get("source").id||t.previous("source").id,r=t.get("target").id||t.previous("target").id;if(a&&r){var n=e.getLinks().filter(function(e){var t=e.source().id,n=e.target().id;return t===a&&n===r||t===r&&n===a}),i=n.length;switch(i){case 0:break;default:1===i&&t.unset("vertices");var o=e.getCell(a).getBBox().center(),s=e.getCell(r).getBBox().center(),l=w.a.g.Line(o,s).midpoint(),c=o.theta(s);I.a.each(n,function(e,t){var a=20*Math.ceil(t/2),r=t%2?1:-1;i%2===0&&(a-=10*r);var n=c<180?1:-1,o=w.a.g.toRad(c+r*n*90),s=w.a.g.Point.fromPolar(a,o,l);e.vertices([s])})}}else t.unset("vertices")}}w.a.shapes.basic.Circle.define("fsa.State",{attrs:{circle:{"stroke-width":2},text:{"font-weight":"800"}}}),w.a.shapes.standard.Link.define("fsa.CustomArrow",{attrs:{line:{sourceMarker:{type:"circle",width:5,stroke:"none"}}},smooth:!0});var F=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).graph=new w.a.dia.Graph;var r=I.a.partial(O,a.graph);return a.graph.on("add remove change:source change:target",r),a.state_shape_width=50,a.state_shape_height=50,a.state_spacing_x=250,a.state_spacing_y=150,a.state_per_row=3,a.cellId2FSMElement={},a.renderAllStates=a.renderAllStates.bind(Object(d.a)(Object(d.a)(a))),a.renderAllTransitions=a.renderAllTransitions.bind(Object(d.a)(Object(d.a)(a))),a.getStateName2CellMap=a.getStateName2CellMap.bind(Object(d.a)(Object(d.a)(a))),a.clearGraph=a.clearGraph.bind(Object(d.a)(Object(d.a)(a))),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.onClickCell,a=e.paperWidth;this.$el=v()(this.el),console.log("paper width is: "+a);var r=new w.a.dia.Paper({el:this.$el,width:a,height:5*a,gridSize:1,model:this.graph,restrictTranslate:!0});r.on("cell:pointerdblclick",t),r.on("cell:pointerclick",t),this.state_per_row=Math.floor(parseInt(r.options.width,10)/(this.state_shape_width+this.state_spacing_x))+1}},{key:"componentWillUnmount",value:function(){this.graph.clear(),this.cellId2FSMElement={}}},{key:"componentDidUpdate",value:function(){}},{key:"handleStateCallback",value:function(e){this.stateCells.push(e)}},{key:"renderAllStates",value:function(e){var t=this;return e.getStatesList().map(function(a,r){var n,i,o,s=(n=Math.floor(r%t.state_per_row)*t.state_spacing_x,i=Math.floor(r/t.state_per_row)*t.state_spacing_y,o=a.getName(),new w.a.shapes.fsa.State({position:{x:n,y:i},size:{width:100,height:100},attrs:{text:{text:o}}}));return e.getStartState()===a.getName()&&s.attr("circle/stroke-width","5"),t.addGraphCellWithRef(s,a),null},this)}},{key:"renderAllTransitions",value:function(e){var t=this,a=e.getStatesList(),r=this.getStateName2CellMap();return a.map(function(e){return e.getTransitionsList().map(function(a){var n,i,o,s=(n=r[e.getName()],i=r[a.getNextState()],o=a.getName(),new w.a.shapes.fsa.CustomArrow({source:{id:n.id},target:{id:i.id},labels:[{position:.5,attrs:{text:{text:o||""}}}]}));return t.addGraphCellWithRef(s,a),null},t)},this)}},{key:"getStateName2CellMap",value:function(){var e=this.graph.getElements(),t={};return e.map(function(e){var a=e.attr("text/text");return a in t?console.error("Duplicate State Name: "+a):t[a]=e,null}),t}},{key:"addGraphCellWithRef",value:function(e,t){this.graph.addCell(e),this.cellId2FSMElement[e.id]=t}},{key:"clearGraph",value:function(){this.graph.clear(),this.cellId2FSMElement={}}},{key:"render",value:function(){var e=this,t=this.props.fsm;return null!=t&&(this.clearGraph(),this.renderAllStates(t),this.renderAllTransitions(t)),n.a.createElement("div",{ref:function(t){return e.el=t}})}}]),t}(r.Component),B=(a(58),a(127)),k=a(125),P=a(54),C=a(113),j=a.n(C),R=a(27),A=a.n(R),L=a(49),W=a(50),_=a(85),z={STATE:Symbol("state"),TRANSITION:Symbol("transition")};Object.freeze(z);var x=function(e){return"function"===typeof e.getProcessorsList?z.STATE:z.TRANSITION};function D(e){return e===Object(e)}var U=function(e,t){if(t){for(var a=(t=t.replace(/^\./,"")).split("."),r=0,n=a.length;r<n;++r){var i=a[r];if(!(D(e)&&i in e))return;e=e[i]}return e}},G=function(e,t){var a=null;return t.getStatesList().map(function(t){return t.getName()===e&&(a=t),null}),a},V=function(e,t){var a=null;return t.getStatesList().map(function(t){return t.getTransitionsList().map(function(r){return r===e&&(a=t),null}),null}),a},K=function(e,t){var a={callable:[]},r=x(e),n=e.getName();switch(a.name=n,r){case z.STATE:a.isStartState=e.getName()===t.getStartState();break;case z.TRANSITION:a.to=e.getNextState(),a.from=V(e,t).getName(),a.instruction={},a.instruction.audio=e.getInstruction().getAudio(),a.instruction.image=e.getInstruction().getImage(),a.instruction.video=e.getInstruction().getVideo();break;default:throw new Error("Unsupported Element Type: "+r+". Failed to add a new element")}return a.callable=function(e){var t=[];return e.map(function(e){var a={};a.name=e.getName(),a.type=e.getCallableName();var r=JSON.parse(e.getCallableArgs());return a.args={},Object.keys(r).map(function(e){return a.args[e]=r[e],null}),t.push(a),null}),t}(function(e){var t=x(e),a=null;switch(t){case z.STATE:a=e.getProcessorsList();break;case z.TRANSITION:a=e.getPredicatesList();break;default:throw new Error("Unsupported Element Type: "+t+". Failed to add a new element")}return a}(e)),a},J=function(e,t,a,r){for(var n=[],i=function(t){var i=e[t],o=new a;o.setName(i.name),o.setCallableName(i.type);var s={};Object.keys(r[i.type]).map(function(e){return s[e]=i.args[e],null}),o.setCallableArgs(JSON.stringify(s)),n.push(o)},o=0;o<e.length;o++)i(o);t(n)},$=function(e,t,a,r){var n=null;if(null===r||void 0===r)switch(a){case z.STATE:n=new _.State,t.addStates(n);break;case z.TRANSITION:n=new _.Transition,G(e.from,t).addTransitions(n);break;default:throw new Error("Unsupported Element Type: "+a+". Failed to add a new element")}else n=r;switch(a){case z.STATE:!function(e,t,a){var r=a.fsm,n=e.getName();n&&r.getStatesList().map(function(e){return e.getTransitionsList().map(function(e){return e.getNextState()===n&&e.setNextState(t),null}),null}),e.setName(t)}(n,e.name,{fsm:t}),e.isStartState&&t.setStartState(e.name),J(e.callable,n.setProcessorsList.bind(n),_.Processor,L);break;case z.TRANSITION:n.setName(e.name),function(e,t,a){var r=a.fsm,n=V(e,r);if(t!==n.getName()){var i=n.getTransitionsList().indexOf(e);i>-1&&n.getTransitionsList().splice(i,1),G(t,r).addTransitions(e)}}(n,e.from,{fsm:t,oldFromStateName:e.from}),n.setNextState(e.to);var i=new _.Instruction;e.instruction&&(i.setAudio(e.instruction.audio),i.setImage(e.instruction.image),i.setVideo(e.instruction.video)),n.setInstruction(i),J(e.callable,n.setPredicatesList.bind(n),_.TransitionPredicate,W);break;default:throw new Error("Unsupported Element Type: "+a+". Failed to add a new element")}},H=(a(184),a(112)),q=a.n(H),Q=function(e,t,a){var r=Math.max.apply(Math,Object(B.a)(e.map(function(e){return("".concat(e[t])||"").length})).concat([a.length]));return Math.min(400,11*r)},X=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).imageInstUrl=null,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"prepareResource",value:function(e){var t={};if(null!==this.imageInstUrl&&URL.revokeObjectURL(this.imageInstUrl),e.getInstruction()&&e.getInstruction().getImage()){var a=new Blob([e.getInstruction().getImage()],{type:"image"});this.imageInstUrl=URL.createObjectURL(a),t.imageInstUrl=this.imageInstUrl}return t}},{key:"render",value:function(){var e=this.props.element,t=x(e),a={};t===z.TRANSITION&&(a=this.prepareResource(e));var r=t===z.STATE?e.getProcessorsList().map(function(e){return{name:e.getName(),callable_name:e.getCallableName(),callable_args:JSON.parse(e.getCallableArgs())}}):e.getPredicatesList().map(function(e){return{name:e.getName(),callable_name:e.getCallableName(),callable_args:JSON.parse(e.getCallableArgs())}}),i=[{Header:"Name",accessor:"name",filterMethod:function(e,t){return Object(P.a)(t,e.value,{keys:["name"]})},filterAll:!0,width:Q(r,"name","Name")},{Header:"Type",accessor:"callable_name",filterMethod:function(e,t){return Object(P.a)(t,e.value,{keys:["callable_name"]})},filterAll:!0,width:Q(r,"callable_name","Type")},{Header:"Arguments",accessor:"callable_args",filterMethod:function(e,t){return Object(P.a)(t,e.value,{keys:["callable_args"]})},Cell:function(e){return n.a.createElement(q.a,{src:e.value})},filterAll:!0}];return n.a.createElement(j.a,{style:{width:"100%",margin:"20px"}},n.a.createElement(A.a,{variant:"secondary"},"Name: ",e.getName()),n.a.createElement(A.a,{variant:"secondary"},"Type: ",t===z.STATE?"State":"Transition"),t===z.TRANSITION&&n.a.createElement(n.a.Fragment,null,n.a.createElement(A.a,{variant:"secondary"},"Instruction"),n.a.createElement(A.a,null,"Audio: ",e.getInstruction().getAudio()),a.imageInstUrl?n.a.createElement(A.a,null,"Image: ",n.a.createElement("img",{src:a.imageInstUrl,alt:"instruction"})):n.a.createElement(A.a,null,"Image: "),n.a.createElement(A.a,null,"Video: ",e.getInstruction().getVideo())),n.a.createElement(A.a,{variant:"secondary"},t===z.STATE?"Processors":"Transition Predicates"),n.a.createElement(k.a,{data:r,filterable:!0,defaultFilterMethod:function(e,t){return String(t[e.id])===e.value},columns:i,defaultPageSize:3},function(e,t,a){return n.a.createElement("div",null,t())}))}}]),t}(r.Component),Y=a(20),Z=a.n(Y),ee=a(114),te=a.n(ee),ae=a(38),re=a.n(ae),ne=a(51),ie=a.n(ne),oe=function(e){var t=e.onImport,a=e.onAdd,r=e.onExport,i=e.onEdit,o=e.onDelete;return n.a.createElement(n.a.Fragment,null,n.a.createElement(f.a,null,n.a.createElement(te.a,null,n.a.createElement(y.a,{sm:3},n.a.createElement(Z.a,{variant:"primary",className:"fw-btn"}," Generate ")),n.a.createElement(y.a,{sm:3},n.a.createElement(ie.a,{as:"buffer",onChange:t},n.a.createElement(Z.a,{variant:"primary",className:"fw-btn"},"Import"))),n.a.createElement(y.a,{sm:3},n.a.createElement(Z.a,{variant:"primary",onClick:r,className:"fw-btn"},"Export")),n.a.createElement(y.a,{sm:3},n.a.createElement(re.a,null,n.a.createElement(re.a.Toggle,{id:"dropdown-add",className:"fw-btn"},"Add"),n.a.createElement(re.a.Menu,null,n.a.createElement(re.a.Item,{onClick:function(){return a(z.STATE)}},"State"),n.a.createElement(re.a.Item,{onClick:function(){return a(z.TRANSITION)}},"Transition")))),n.a.createElement(y.a,{sm:3},n.a.createElement(Z.a,{variant:"primary",onClick:i,className:"fw-btn"},"Edit")),n.a.createElement(y.a,{sm:3},n.a.createElement(Z.a,{variant:"primary",onClick:o,className:"fw-btn"},"Delete")))))},se=a(44),le=a(39),ce=a.n(le),ue=a(19),pe=a.n(ue),de=a(17),ge=a(128),me=function(e){var t=null;return void 0!==e&&null!==e&&/^.+$/i.test(e)||(t="Required. Cannot be empty."),t},he=function(e){var t=e.field,a=e.type,r=e.label,i=e.placeholder,o=e.defaultValue,s=e.isValid,l=Object(se.a)(e,["field","type","label","placeholder","defaultValue","isValid"]);return n.a.createElement(pe.a.Group,{as:f.a},n.a.createElement(pe.a.Label,{column:!0},r),n.a.createElement(y.a,null,n.a.createElement(pe.a.Control,Object.assign({required:!0},t,l,{type:a,placeholder:i,value:t.value||o||"",isValid:s}))))},fe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).imageInstUrl=null,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"prepareResource",value:function(e){null!==this.imageInstUrl&&URL.revokeObjectURL(this.imageInstUrl);var t=new Blob([e],{type:"image"});return this.imageInstUrl=URL.createObjectURL(t),{imageInstUrl:this.imageInstUrl}}},{key:"render",value:function(){var e=this.props,t=e.field,a=e.form,r=e.label,i={};return t.value&&(i=this.prepareResource(t.value)),n.a.createElement(pe.a.Group,{as:f.a},n.a.createElement(pe.a.Label,{column:!0},r),i.imageInstUrl&&n.a.createElement(pe.a.Label,{column:!0,sm:1},n.a.createElement("img",{src:i.imageInstUrl,alt:"instruction",style:{width:40,height:40}})),n.a.createElement(y.a,null,n.a.createElement(ie.a,{as:"buffer",onChange:function(e,r){r.forEach(function(e){var r=e[0].target.result;a.setFieldValue(t.name,new Uint8Array(r))})}},n.a.createElement(Z.a,{variant:"light",className:"fw-btn"},"New Image"))))}}]),t}(r.Component),be=function(e){var t=e.field,a=e.form,r=e.label,i=e.selectOptions,o=Object(se.a)(e,["field","form","label","selectOptions"]);return n.a.createElement(pe.a.Group,{as:f.a},n.a.createElement(pe.a.Label,{column:!0},r),n.a.createElement(y.a,null,n.a.createElement(ge.a,Object.assign({},t,o,{options:i,name:t.name,value:i?i.find(function(e){return e.value===t.value}):"",onChange:function(e){return a.setFieldValue(t.name,e.value)},onBlur:t.onBlur}))))},ye=function(e){var t=e.field,a=Object(se.a)(e,["field"]);return n.a.createElement(he,Object.assign({field:t,type:"text",label:"name",placeholder:"Enter Name"},a))},Se=function(e){var t=e.field,a=(e.key,e.label),r=e.placeholder,i=Object(se.a)(e,["field","key","label","placeholder"]);return n.a.createElement(he,Object.assign({field:t,type:"text",label:a,placeholder:r},i))},Ee=function(e,t){return U(e,t)?n.a.createElement("div",{className:"text-danger"},U(e,t)):null},Me=function(e,t,a,r,i,o){var s=function(e){return Object.keys(e).map(function(e){return{value:e,label:e}})}(t);return n.a.createElement("div",{key:r,className:"border"},n.a.createElement("h6",null,e),n.a.createElement(de.a,{name:"callable.".concat(r,".name"),component:ye,validate:me}),Ee(o,"callable.".concat(r,".name")),n.a.createElement(de.a,{name:"callable.".concat(r,".type"),component:be,label:"Type",selectOptions:s,validate:me}),Ee(o,"callable.".concat(r,".type")),U(a,"callable.".concat(r,".type"))&&ve(t[a.callable[r].type],r,o),n.a.createElement(pe.a.Row,null,n.a.createElement(Z.a,{variant:"danger",className:"btn-block",onClick:function(){return i.remove({index:r})}},"Delete")))},ve=function(e,t,a){return Object.keys(e).map(function(r,i){return n.a.createElement("div",{key:t+".arg."+i},n.a.createElement(de.a,{name:"callable.".concat(t,".args.").concat(r),component:Se,label:r,placeholder:e[r],defaultValue:"",validate:me}),Ee(a,"callable.".concat(t,".args.").concat(r)))})},Te=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).form=n.a.createRef(),a.onHide=a.onHide.bind(Object(d.a)(Object(d.a)(a))),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"onHide",value:function(){}},{key:"getInitModalValuesFromElement",value:function(e,t){return null===e?{callable:[]}:K(e,t)}},{key:"render",value:function(){var e,t=this,a=this.props,r=a.show,i=a.type,o=a.fsm,s=a.onModalCancel,l=a.onModalSave,c=a.initElement,u="",p=null,d="";switch(i){case z.STATE:e="State",u="New Processor",d="Add Processor",p=L;break;case z.TRANSITION:e="Transition",u="New Predicate",d="Add Predicate",p=W;break;default:throw new Error("Unsupported Element Type: "+i+". Failed to add a new element")}var g=this.getInitModalValuesFromElement(c,o);return n.a.createElement(ce.a,{show:r,onHide:this.onHide},n.a.createElement(ce.a.Header,null,n.a.createElement(ce.a.Title,null,e)),n.a.createElement(ce.a.Body,null,n.a.createElement(de.d,{ref:this.form,initialValues:g,onSubmit:function(e,t){t.props;var a=t.setSubmitting;l(i,e,c),a(!1)},render:function(e){e.form;var t=e.values,a=e.errors;return n.a.createElement(de.c,null,n.a.createElement(de.b,{name:"callable",render:function(e){return n.a.createElement(n.a.Fragment,null,i===z.STATE&&n.a.createElement(n.a.Fragment,null,n.a.createElement(de.a,{name:"name",component:he,type:"text",label:"Name",validate:function(e){return null===c||void 0===c?function(e,t){return me(e)||function(e,t){var a=null;return(void 0===e||null===e||t.includes(e))&&(a="Duplicate name. Names must be unique."),a}(e,t)||null}(e,o.getStatesList().map(function(e){return e.getName()})):me(e)}}),Ee(a,"name"),n.a.createElement(de.a,{name:"isStartState"},function(e){var a=e.field,r=e.form;return n.a.createElement(pe.a.Group,{as:f.a},n.a.createElement(pe.a.Label,{column:!0},"Start from this state?"),n.a.createElement(y.a,null,n.a.createElement(pe.a.Control,{type:"checkbox",checked:t[a.name],onChange:function(){t[a.name]?r.setFieldValue(a.name,!1):r.setFieldValue(a.name,!0)}})))})),i===z.TRANSITION&&n.a.createElement(n.a.Fragment,null,n.a.createElement(de.a,{name:"name",component:he,type:"text",label:"Name",validate:me}),Ee(a,"name"),function(e,t,a){var r=e.getStatesList().map(function(e){return{value:e.getName(),label:e.getName()}});return n.a.createElement(n.a.Fragment,null,n.a.createElement(de.a,{name:"from",component:be,label:"From State",selectOptions:r,validate:me}),Ee(a,"from"),n.a.createElement(de.a,{name:"to",component:be,label:"To State",selectOptions:r,validate:me}),Ee(a,"to"),n.a.createElement(de.a,{name:"instruction.audio",component:he,type:"text",label:"Audio Instruction",defaultValue:""}),n.a.createElement(de.a,{name:"instruction.image",component:fe,label:"Image Instruction"}),n.a.createElement(de.a,{name:"instruction.video",component:he,type:"text",label:"Video Instruction",defaultValue:""}))}(o,0,a)),t.callable.map(function(r,n){return Me(u,p,t,n,e,a)}),n.a.createElement(pe.a.Row,null,n.a.createElement(Z.a,{variant:"info",className:"btn-block",onClick:function(){return e.push({})}},d)))}}))}})),n.a.createElement(ce.a.Footer,null,n.a.createElement(Z.a,{variant:"secondary",onClick:s},"Close"),n.a.createElement(Z.a,{variant:"primary",onClick:function(e){t.form.current.submitForm()}},"Save Changes")))}}]),t}(r.Component),we=a(123),Ne=a.n(we),Ie=a(85);var Oe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).diagramRef=n.a.createRef(),a.diagramContainerRef=n.a.createRef(),a.alert=a.alert.bind(Object(d.a)(Object(d.a)(a))),a.onImport=a.onImport.bind(Object(d.a)(Object(d.a)(a))),a.onExport=a.onExport.bind(Object(d.a)(Object(d.a)(a))),a.onAdd=a.onAdd.bind(Object(d.a)(Object(d.a)(a))),a.onDelete=a.onDelete.bind(Object(d.a)(Object(d.a)(a))),a.onEdit=a.onEdit.bind(Object(d.a)(Object(d.a)(a))),a.onClickCell=a.onClickCell.bind(Object(d.a)(Object(d.a)(a))),a.onModalCancel=a.onModalCancel.bind(Object(d.a)(Object(d.a)(a))),a.onModalSave=a.onModalSave.bind(Object(d.a)(Object(d.a)(a))),a.state={fsm:new Ie.StateMachine,curFSMElement:null,modalInitElement:null,alertMsg:{show:!0,type:"info",msg:"Welcome to State Machine Editor!"},showNewElementModal:!1,newElementModalType:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(m.a,{fluid:!0},n.a.createElement("h1",null,"Gabriel State Machine Editor"),""!==this.state.alertMsg.msg&&n.a.createElement(E.a,{dismissible:!0,variant:this.state.alertMsg.type},this.state.alertMsg.msg),n.a.createElement(f.a,null,n.a.createElement(y.a,{sm:6,ref:this.diagramContainerRef,style:{backgroundColor:"lavender"}},n.a.createElement("h4",null,"Diagram"),n.a.createElement(F,{fsm:this.state.fsm,onClickCell:this.onClickCell,ref:this.diagramRef,paperWidth:window.innerWidth/2})),n.a.createElement(y.a,{sm:6},n.a.createElement(oe,{onImport:this.onImport,onAdd:this.onAdd,onExport:this.onExport,onDelete:this.onDelete,onEdit:this.onEdit}),this.state.curFSMElement&&n.a.createElement(f.a,null,n.a.createElement(X,{element:this.state.curFSMElement,style:{width:"100%"}})))),n.a.createElement("footer",null,n.a.createElement(m.a,null,n.a.createElement("span",{className:"text-muted"},"Copyright Carnegie Mellon University"))),this.state.showNewElementModal&&n.a.createElement(Te,{fsm:this.state.fsm,show:this.state.showNewElementModal,type:this.state.newElementModalType,initElement:this.state.modalInitElement,onModalSave:this.onModalSave,onModalCancel:this.onModalCancel}))}},{key:"alert",value:function(e,t){this.setState({alertMsg:{type:e,msg:t}})}},{key:"onImport",value:function(e,t){var a=this;t.forEach(function(e){var t=e[0].target.result,r=null;try{r=function(e){var t=null;try{t=Ie.StateMachine.deserializeBinary(e)}catch(a){throw a}return t}(t),a.setState({fsm:r,curFSMElement:null}),a.alert("info","Success! State machine imported.")}catch(n){a.alert("danger","Incorrect File Format. Failed to import the file. \n"+n)}})}},{key:"onExport",value:function(){var e=this.state.fsm;if(0===e.getStatesList().length)this.alert("danger","Empty state machine! There is nothing to save. \n");else{""===e.getStartState()&&e.setStartState(e.getStatesList()[0].getName());var t=e.serializeBinary(),a=new Blob([t],{type:"application/octet-stream"});Ne()(a,"app.pbfsm")}}},{key:"onAdd",value:function(e){this.setState({showNewElementModal:!0,newElementModalType:e})}},{key:"isElementSafeToDelete",value:function(e){var t=this.state.fsm,a=x(e),r=!0;switch(a){case z.STATE:return e.getTransitionsList().length>0&&(r=!1),t.getStatesList().map(function(t){return t.getTransitionsList().map(function(t){return t.getNextState()===e.getName()&&(r=!1),null}),null}),r;case z.TRANSITION:return r;default:throw new Error("Unsupported Element Type: "+a)}}},{key:"deleteStatePb",value:function(e){var t=this.state.fsm;if(!this.isElementSafeToDelete(e))return this.alert("danger","A state cannot be deleted unless all transitions to/from it have been deleted.");var a=t.getStatesList().indexOf(e);t.getStatesList().splice(a,1),this.setState({fsm:t,curFSMElement:null})}},{key:"deleteTransitionPb",value:function(e){var t=this.state.fsm;if(!this.isElementSafeToDelete(e))return this.alert("danger","The transition cannot be safely deleted");t.getStatesList().map(function(t){var a=t.getTransitionsList().indexOf(e);return a>=0&&t.getTransitionsList().splice(a,a+1),null}),this.setState({fsm:t,curFSMElement:null})}},{key:"hasCurElement",value:function(){return null!==this.state.curFSMElement||(this.alert("danger","There is no element selected. Double-click to select an element."),!1)}},{key:"onEdit",value:function(){if(this.hasCurElement()){var e=this.state.curFSMElement,t=x(e);this.setState({showNewElementModal:!0,newElementModalType:t,modalInitElement:e})}}},{key:"onDelete",value:function(){if(this.hasCurElement()){var e=this.state.curFSMElement,t=x(e);switch(t){case z.STATE:this.deleteStatePb(e);break;case z.TRANSITION:this.deleteTransitionPb(e);break;default:throw new Error("Unsupported Element Type: "+t)}}}},{key:"onClickCell",value:function(e){var t=this.diagramRef.current.cellId2FSMElement[e.model.id];this.setState({curFSMElement:t})}},{key:"onModalSave",value:function(e,t,a){var r=this.state.fsm;$(t,r,e,a),this.setState({fsm:r}),this.setState({showNewElementModal:!1,modalInitElement:null})}},{key:"onModalCancel",value:function(){this.setState({showNewElementModal:!1,modalInitElement:null})}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(Oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},49:function(e){e.exports={FasterRCNNOpenCVProcessor:{proto_path:"",model_path:"",labels:"None",conf_threshold:"0.8"},DummyProcessor:{dummy_input:"dummy_input_value"},FasterRCNNProcessor:{proto_path:"",model_path:"",labels:"None",conf_threshold:"0.8"}}},50:function(e){e.exports={always:{},has_obj_cls:{cls_name:""}}},58:function(e,t,a){},85:function(e,t,a){var r=a(179),n=r,i=Function("return this")();n.exportSymbol("proto.Instruction",null,i),n.exportSymbol("proto.Processor",null,i),n.exportSymbol("proto.State",null,i),n.exportSymbol("proto.StateMachine",null,i),n.exportSymbol("proto.Transition",null,i),n.exportSymbol("proto.TransitionPredicate",null,i),proto.TransitionPredicate=function(e){r.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.TransitionPredicate,r.Message),n.DEBUG&&!COMPILED&&(proto.TransitionPredicate.displayName="proto.TransitionPredicate"),r.Message.GENERATE_TO_OBJECT&&(proto.TransitionPredicate.prototype.toObject=function(e){return proto.TransitionPredicate.toObject(e,this)},proto.TransitionPredicate.toObject=function(e,t){var a,n={name:r.Message.getFieldWithDefault(t,1,""),callableName:r.Message.getFieldWithDefault(t,2,""),callableKwargsMap:(a=t.getCallableKwargsMap())?a.toObject(e,void 0):[],callableArgs:r.Message.getFieldWithDefault(t,4,"")};return e&&(n.$jspbMessageInstance=t),n}),proto.TransitionPredicate.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.TransitionPredicate;return proto.TransitionPredicate.deserializeBinaryFromReader(a,t)},proto.TransitionPredicate.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=t.readString();e.setCallableName(a);break;case 3:a=e.getCallableKwargsMap();t.readMessage(a,function(e,t){r.Map.deserializeBinary(e,t,r.BinaryReader.prototype.readString,r.BinaryReader.prototype.readBytes,null,"")});break;case 4:a=t.readString();e.setCallableArgs(a);break;default:t.skipField()}}return e},proto.TransitionPredicate.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.TransitionPredicate.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.TransitionPredicate.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getCallableName()).length>0&&t.writeString(2,a),(a=e.getCallableKwargsMap(!0))&&a.getLength()>0&&a.serializeBinary(3,t,r.BinaryWriter.prototype.writeString,r.BinaryWriter.prototype.writeBytes),(a=e.getCallableArgs()).length>0&&t.writeString(4,a)},proto.TransitionPredicate.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.TransitionPredicate.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.TransitionPredicate.prototype.getCallableName=function(){return r.Message.getFieldWithDefault(this,2,"")},proto.TransitionPredicate.prototype.setCallableName=function(e){r.Message.setProto3StringField(this,2,e)},proto.TransitionPredicate.prototype.getCallableKwargsMap=function(e){return r.Message.getMapField(this,3,e,null)},proto.TransitionPredicate.prototype.clearCallableKwargsMap=function(){this.getCallableKwargsMap().clear()},proto.TransitionPredicate.prototype.getCallableArgs=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.TransitionPredicate.prototype.setCallableArgs=function(e){r.Message.setProto3StringField(this,4,e)},proto.Instruction=function(e){r.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.Instruction,r.Message),n.DEBUG&&!COMPILED&&(proto.Instruction.displayName="proto.Instruction"),r.Message.GENERATE_TO_OBJECT&&(proto.Instruction.prototype.toObject=function(e){return proto.Instruction.toObject(e,this)},proto.Instruction.toObject=function(e,t){var a={name:r.Message.getFieldWithDefault(t,1,""),audio:r.Message.getFieldWithDefault(t,2,""),image:t.getImage_asB64(),video:t.getVideo_asB64()};return e&&(a.$jspbMessageInstance=t),a}),proto.Instruction.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.Instruction;return proto.Instruction.deserializeBinaryFromReader(a,t)},proto.Instruction.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=t.readString();e.setAudio(a);break;case 3:a=t.readBytes();e.setImage(a);break;case 4:a=t.readBytes();e.setVideo(a);break;default:t.skipField()}}return e},proto.Instruction.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.Instruction.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.Instruction.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getAudio()).length>0&&t.writeString(2,a),(a=e.getImage_asU8()).length>0&&t.writeBytes(3,a),(a=e.getVideo_asU8()).length>0&&t.writeBytes(4,a)},proto.Instruction.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.Instruction.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.Instruction.prototype.getAudio=function(){return r.Message.getFieldWithDefault(this,2,"")},proto.Instruction.prototype.setAudio=function(e){r.Message.setProto3StringField(this,2,e)},proto.Instruction.prototype.getImage=function(){return r.Message.getFieldWithDefault(this,3,"")},proto.Instruction.prototype.getImage_asB64=function(){return r.Message.bytesAsB64(this.getImage())},proto.Instruction.prototype.getImage_asU8=function(){return r.Message.bytesAsU8(this.getImage())},proto.Instruction.prototype.setImage=function(e){r.Message.setProto3BytesField(this,3,e)},proto.Instruction.prototype.getVideo=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.Instruction.prototype.getVideo_asB64=function(){return r.Message.bytesAsB64(this.getVideo())},proto.Instruction.prototype.getVideo_asU8=function(){return r.Message.bytesAsU8(this.getVideo())},proto.Instruction.prototype.setVideo=function(e){r.Message.setProto3BytesField(this,4,e)},proto.Transition=function(e){r.Message.initialize(this,e,0,-1,proto.Transition.repeatedFields_,null)},n.inherits(proto.Transition,r.Message),n.DEBUG&&!COMPILED&&(proto.Transition.displayName="proto.Transition"),proto.Transition.repeatedFields_=[2],r.Message.GENERATE_TO_OBJECT&&(proto.Transition.prototype.toObject=function(e){return proto.Transition.toObject(e,this)},proto.Transition.toObject=function(e,t){var a,n={name:r.Message.getFieldWithDefault(t,1,""),predicatesList:r.Message.toObjectList(t.getPredicatesList(),proto.TransitionPredicate.toObject,e),instruction:(a=t.getInstruction())&&proto.Instruction.toObject(e,a),nextState:r.Message.getFieldWithDefault(t,4,"")};return e&&(n.$jspbMessageInstance=t),n}),proto.Transition.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.Transition;return proto.Transition.deserializeBinaryFromReader(a,t)},proto.Transition.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=new proto.TransitionPredicate;t.readMessage(a,proto.TransitionPredicate.deserializeBinaryFromReader),e.addPredicates(a);break;case 3:a=new proto.Instruction;t.readMessage(a,proto.Instruction.deserializeBinaryFromReader),e.setInstruction(a);break;case 4:a=t.readString();e.setNextState(a);break;default:t.skipField()}}return e},proto.Transition.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.Transition.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.Transition.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getPredicatesList()).length>0&&t.writeRepeatedMessage(2,a,proto.TransitionPredicate.serializeBinaryToWriter),null!=(a=e.getInstruction())&&t.writeMessage(3,a,proto.Instruction.serializeBinaryToWriter),(a=e.getNextState()).length>0&&t.writeString(4,a)},proto.Transition.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.Transition.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.Transition.prototype.getPredicatesList=function(){return r.Message.getRepeatedWrapperField(this,proto.TransitionPredicate,2)},proto.Transition.prototype.setPredicatesList=function(e){r.Message.setRepeatedWrapperField(this,2,e)},proto.Transition.prototype.addPredicates=function(e,t){return r.Message.addToRepeatedWrapperField(this,2,e,proto.TransitionPredicate,t)},proto.Transition.prototype.clearPredicatesList=function(){this.setPredicatesList([])},proto.Transition.prototype.getInstruction=function(){return r.Message.getWrapperField(this,proto.Instruction,3)},proto.Transition.prototype.setInstruction=function(e){r.Message.setWrapperField(this,3,e)},proto.Transition.prototype.clearInstruction=function(){this.setInstruction(void 0)},proto.Transition.prototype.hasInstruction=function(){return null!=r.Message.getField(this,3)},proto.Transition.prototype.getNextState=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.Transition.prototype.setNextState=function(e){r.Message.setProto3StringField(this,4,e)},proto.Processor=function(e){r.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.Processor,r.Message),n.DEBUG&&!COMPILED&&(proto.Processor.displayName="proto.Processor"),r.Message.GENERATE_TO_OBJECT&&(proto.Processor.prototype.toObject=function(e){return proto.Processor.toObject(e,this)},proto.Processor.toObject=function(e,t){var a,n={name:r.Message.getFieldWithDefault(t,1,""),callableName:r.Message.getFieldWithDefault(t,2,""),callableKwargsMap:(a=t.getCallableKwargsMap())?a.toObject(e,void 0):[],callableArgs:r.Message.getFieldWithDefault(t,4,"")};return e&&(n.$jspbMessageInstance=t),n}),proto.Processor.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.Processor;return proto.Processor.deserializeBinaryFromReader(a,t)},proto.Processor.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=t.readString();e.setCallableName(a);break;case 3:a=e.getCallableKwargsMap();t.readMessage(a,function(e,t){r.Map.deserializeBinary(e,t,r.BinaryReader.prototype.readString,r.BinaryReader.prototype.readBytes,null,"")});break;case 4:a=t.readString();e.setCallableArgs(a);break;default:t.skipField()}}return e},proto.Processor.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.Processor.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.Processor.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getCallableName()).length>0&&t.writeString(2,a),(a=e.getCallableKwargsMap(!0))&&a.getLength()>0&&a.serializeBinary(3,t,r.BinaryWriter.prototype.writeString,r.BinaryWriter.prototype.writeBytes),(a=e.getCallableArgs()).length>0&&t.writeString(4,a)},proto.Processor.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.Processor.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.Processor.prototype.getCallableName=function(){return r.Message.getFieldWithDefault(this,2,"")},proto.Processor.prototype.setCallableName=function(e){r.Message.setProto3StringField(this,2,e)},proto.Processor.prototype.getCallableKwargsMap=function(e){return r.Message.getMapField(this,3,e,null)},proto.Processor.prototype.clearCallableKwargsMap=function(){this.getCallableKwargsMap().clear()},proto.Processor.prototype.getCallableArgs=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.Processor.prototype.setCallableArgs=function(e){r.Message.setProto3StringField(this,4,e)},proto.State=function(e){r.Message.initialize(this,e,0,-1,proto.State.repeatedFields_,null)},n.inherits(proto.State,r.Message),n.DEBUG&&!COMPILED&&(proto.State.displayName="proto.State"),proto.State.repeatedFields_=[2,3],r.Message.GENERATE_TO_OBJECT&&(proto.State.prototype.toObject=function(e){return proto.State.toObject(e,this)},proto.State.toObject=function(e,t){var a={name:r.Message.getFieldWithDefault(t,1,""),processorsList:r.Message.toObjectList(t.getProcessorsList(),proto.Processor.toObject,e),transitionsList:r.Message.toObjectList(t.getTransitionsList(),proto.Transition.toObject,e)};return e&&(a.$jspbMessageInstance=t),a}),proto.State.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.State;return proto.State.deserializeBinaryFromReader(a,t)},proto.State.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=new proto.Processor;t.readMessage(a,proto.Processor.deserializeBinaryFromReader),e.addProcessors(a);break;case 3:a=new proto.Transition;t.readMessage(a,proto.Transition.deserializeBinaryFromReader),e.addTransitions(a);break;default:t.skipField()}}return e},proto.State.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.State.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.State.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getProcessorsList()).length>0&&t.writeRepeatedMessage(2,a,proto.Processor.serializeBinaryToWriter),(a=e.getTransitionsList()).length>0&&t.writeRepeatedMessage(3,a,proto.Transition.serializeBinaryToWriter)},proto.State.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.State.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.State.prototype.getProcessorsList=function(){return r.Message.getRepeatedWrapperField(this,proto.Processor,2)},proto.State.prototype.setProcessorsList=function(e){r.Message.setRepeatedWrapperField(this,2,e)},proto.State.prototype.addProcessors=function(e,t){return r.Message.addToRepeatedWrapperField(this,2,e,proto.Processor,t)},proto.State.prototype.clearProcessorsList=function(){this.setProcessorsList([])},proto.State.prototype.getTransitionsList=function(){return r.Message.getRepeatedWrapperField(this,proto.Transition,3)},proto.State.prototype.setTransitionsList=function(e){r.Message.setRepeatedWrapperField(this,3,e)},proto.State.prototype.addTransitions=function(e,t){return r.Message.addToRepeatedWrapperField(this,3,e,proto.Transition,t)},proto.State.prototype.clearTransitionsList=function(){this.setTransitionsList([])},proto.StateMachine=function(e){r.Message.initialize(this,e,0,-1,proto.StateMachine.repeatedFields_,null)},n.inherits(proto.StateMachine,r.Message),n.DEBUG&&!COMPILED&&(proto.StateMachine.displayName="proto.StateMachine"),proto.StateMachine.repeatedFields_=[2],r.Message.GENERATE_TO_OBJECT&&(proto.StateMachine.prototype.toObject=function(e){return proto.StateMachine.toObject(e,this)},proto.StateMachine.toObject=function(e,t){var a,n={name:r.Message.getFieldWithDefault(t,1,""),statesList:r.Message.toObjectList(t.getStatesList(),proto.State.toObject,e),assetsMap:(a=t.getAssetsMap())?a.toObject(e,void 0):[],startState:r.Message.getFieldWithDefault(t,4,"")};return e&&(n.$jspbMessageInstance=t),n}),proto.StateMachine.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.StateMachine;return proto.StateMachine.deserializeBinaryFromReader(a,t)},proto.StateMachine.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=new proto.State;t.readMessage(a,proto.State.deserializeBinaryFromReader),e.addStates(a);break;case 3:a=e.getAssetsMap();t.readMessage(a,function(e,t){r.Map.deserializeBinary(e,t,r.BinaryReader.prototype.readString,r.BinaryReader.prototype.readBytes,null,"")});break;case 4:a=t.readString();e.setStartState(a);break;default:t.skipField()}}return e},proto.StateMachine.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.StateMachine.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.StateMachine.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getStatesList()).length>0&&t.writeRepeatedMessage(2,a,proto.State.serializeBinaryToWriter),(a=e.getAssetsMap(!0))&&a.getLength()>0&&a.serializeBinary(3,t,r.BinaryWriter.prototype.writeString,r.BinaryWriter.prototype.writeBytes),(a=e.getStartState()).length>0&&t.writeString(4,a)},proto.StateMachine.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.StateMachine.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.StateMachine.prototype.getStatesList=function(){return r.Message.getRepeatedWrapperField(this,proto.State,2)},proto.StateMachine.prototype.setStatesList=function(e){r.Message.setRepeatedWrapperField(this,2,e)},proto.StateMachine.prototype.addStates=function(e,t){return r.Message.addToRepeatedWrapperField(this,2,e,proto.State,t)},proto.StateMachine.prototype.clearStatesList=function(){this.setStatesList([])},proto.StateMachine.prototype.getAssetsMap=function(e){return r.Message.getMapField(this,3,e,null)},proto.StateMachine.prototype.clearAssetsMap=function(){this.getAssetsMap().clear()},proto.StateMachine.prototype.getStartState=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.StateMachine.prototype.setStartState=function(e){r.Message.setProto3StringField(this,4,e)},n.object.extend(t,proto)}},[[129,2,1]]]);
//# sourceMappingURL=main.de5bf9bb.chunk.js.map